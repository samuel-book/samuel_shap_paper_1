
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Probability, odds, and SHAP values (log odds shifts) &#8212; Using explainable machine learning to understand variation in thrombolysis practice</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="A simple worked example of Shap" href="../shap_worked_example.html" />
    <link rel="prev" title="Glossary of technical terms" href="../glossary.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Using explainable machine learning to understand variation in thrombolysis practice</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introductory content
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/outline.html">
   Outline of notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../glossary.html">
   Glossary of technical terms
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Probability, odds, and SHAP values (log odds shifts)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../shap_worked_example.html">
   A simple worked example of Shap
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Predicting thrombolysis use and explaining the predictions with Shap
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/01_xgb_combined_fit_feature_selection.html">
   XGBoost feature selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/07_correlation.html">
   Check correlation between features selected for the model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/02_xgb_combined_fit_accuracy_key_features.html">
   Measuring accuracy of XGBoost models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/03_xgb_combined_shap_key_features.html">
   Explaining XGBoost model predictions with SHAP values
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Comparing thrombolysis decisions between hospitals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/04_compare_10k_cohort_key_features.html">
   A comparison of 10k cohort thrombolysis rates across hospitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/05_compare_benchmark_decisions_key_features.html">
   Compare local thrombolysis decisions with benchmark decisions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/06_predict_differences_between_local_and_benchmark_key_features.html">
   Predicting differences between local and benchmark decisions: Identifying patients that low thrombolsying units would not give thrombolysis to whereas the majority of benchmark hospitals would
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/08_xgb_combined_fit_shap_high_vs_low_thrombolysing_units.html">
   Comparing Shap values between high and low thrombolysing hospitals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../xgb_with_feature_selection/09_plot_thrombolysis_at_high_vs_low_thrombolysing_units.html">
   Plotting thrombolysis rate by feature value for low and high thrombolysing hopsitals
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/introduction/odds_prob.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probability">
   Probability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#odds">
   Odds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shap-values-log-odds-shifts">
   SHAP values: log odds shifts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#positive-shap-values-examples-of-how-shap-change-odds-and-probabilities">
     Positive SHAP values: examples of how SHAP change odds and probabilities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#negative-shap-values-examples-of-how-shap-change-odds-and-probabilities">
     Negative SHAP values: examples of how SHAP change odds and probabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-worked-example-in-predicting-use-of-thrombolysis-in-stroke">
   A worked example in predicting use of thrombolysis in stroke
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#observations-about-shap-values">
     Observations about SHAP values
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Probability, odds, and SHAP values (log odds shifts)</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probability">
   Probability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#odds">
   Odds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shap-values-log-odds-shifts">
   SHAP values: log odds shifts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#positive-shap-values-examples-of-how-shap-change-odds-and-probabilities">
     Positive SHAP values: examples of how SHAP change odds and probabilities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#negative-shap-values-examples-of-how-shap-change-odds-and-probabilities">
     Negative SHAP values: examples of how SHAP change odds and probabilities
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-worked-example-in-predicting-use-of-thrombolysis-in-stroke">
   A worked example in predicting use of thrombolysis in stroke
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#observations-about-shap-values">
     Observations about SHAP values
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="probability-odds-and-shap-values-log-odds-shifts">
<h1>Probability, odds, and SHAP values (log odds shifts)<a class="headerlink" href="#probability-odds-and-shap-values-log-odds-shifts" title="Permalink to this headline">¶</a></h1>
<p>Many of us find it easiest to think of the chance of something occurring as a probability. For example, there might be a probability of 10% that it will rain today. That is the same as saying there will be one rainy day out of ten days for days with this given probability of rain.</p>
<p>In our stroke thrombolysis model, SHAP values tell us how knowing something particular about a patient (such as the patient <em>feature</em>, ‘Is their stroke caused by a clot or a bleed?’) adjusts our prediction of whether they will receive thrombolysis or not.</p>
<p>This is made a little more complicated for us because SHAP is usually reported as a <em>log odds shift</em>. It is useful for us to see how those relate to probabilities, and get a sense of how significant SHAP values in the range of 0.5 to 5 (or -0.5 to -5) are, as that is a common range of SHAP values that we will see in our models.</p>
<div class="section" id="probability">
<h2>Probability<a class="headerlink" href="#probability" title="Permalink to this headline">¶</a></h2>
<p>We will take the example that SHAP reports that a model’s base probability prediction, before the contribution of features is 0.25, or a 25% probability of receiving thrombolysis; that is 1 in 4 patients with this prediction would be expected to receive thrombolysis.</p>
</div>
<div class="section" id="odds">
<h2>Odds<a class="headerlink" href="#odds" title="Permalink to this headline">¶</a></h2>
<p><em>Probability</em> expresses the chance of something happening as the number of positive occurrences as a fraction of all occurrences (i.e. the number of patients receiving thrombolysis as a fraction of the total number of patients).</p>
<p><em>Odds</em> express the chance of something happening as the ratio of the number of positive occurrences (i.e. receiving thrombolysis) to the number of negative occurrences (i.e. <em>not</em> receiving thrombolysis).</p>
<p>If we have probability prediction of 0.25 would receive thrombolysis, that would mean 1 in 4 of those patients receive thrombolysis. Expressed as odds, for every one patient that receives thrombolysis, three will not. The odds are expressed as 1:3 or 1/3. This may also be calculated as a decimal (1 divided by 3), 0.333.</p>
<p>Odds (O) and probability (P) may be converted with the following equations:</p>
<p>(1) O = P / (1 - P)</p>
<p>(2) P = O / (1 + O)</p>
</div>
<div class="section" id="shap-values-log-odds-shifts">
<h2>SHAP values: log odds shifts<a class="headerlink" href="#shap-values-log-odds-shifts" title="Permalink to this headline">¶</a></h2>
<p>Here we will calculate the effect of SHAP values, and try and build some intuition on the size of effect SHAP values of 0.5 to 5 give (we will look at positive and negative SHAP values).</p>
<p>SHAP usually outputs the effect of a particular feature in how much it shifts the odds. For reasons we will not go into here, that shift (which is the ‘SHAP value’) is usually given in ‘log odds’ (the logarithm of the odds value). For the mathematically inclined, we use the natural log (<em>ln</em>).</p>
<p>Let’s look at some SHAP values (log odds) and see how much they change the odds of receiving thrombolysis.</p>
<p>First we’ll look at the shift in odds the SHAP values give. This is calculated as <em>shift = exp(SHAP)</em></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>SHAP (log odds)</p></th>
<th class="head"><p>Shift in odds (multiply original odds)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.5</p></td>
<td><p>1.65</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>2.72</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>7.39</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>20.1</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>54.6</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>148</p></td>
</tr>
</tbody>
</table>
<div class="section" id="positive-shap-values-examples-of-how-shap-change-odds-and-probabilities">
<h3>Positive SHAP values: examples of how SHAP change odds and probabilities<a class="headerlink" href="#positive-shap-values-examples-of-how-shap-change-odds-and-probabilities" title="Permalink to this headline">¶</a></h3>
<p>Now let us work through an example of starting with a known baseline <em>probability</em> (before we consider what we know about a particular patient feature), converting that to <em>odds</em>, applying a SHAP <em>log odds shift</em> for that particular feature, and converting back to <em>probability</em> after we have applied the influence of that feature.</p>
<p>Here are the effects of those shifts on our baseline probability of 0.25.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Starting P</p></th>
<th class="head"><p>Starting O<br>(P / (1 - P))</p></th>
<th class="head"><p>SHAP</p></th>
<th class="head"><p>Shift in odds<br>(exp(SHAP))</p></th>
<th class="head"><p>Shifted O<br>(O * Shift)</p></th>
<th class="head"><p>Shifted P (%)<br>(O / (1 + O))</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>0.5</p></td>
<td><p>1.65</p></td>
<td><p>0.550</p></td>
<td><p>0.3547 (36%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>1</p></td>
<td><p>2.72</p></td>
<td><p>0.907</p></td>
<td><p>0.4754 (48%)</p></td>
</tr>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>2</p></td>
<td><p>7.39</p></td>
<td><p>2.46</p></td>
<td><p>0.7112 (71%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>3</p></td>
<td><p>20.1</p></td>
<td><p>6.70</p></td>
<td><p>0.8700 (87%)</p></td>
</tr>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>4</p></td>
<td><p>54.6</p></td>
<td><p>18.2</p></td>
<td><p>0.9479 (95%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>5</p></td>
<td><p>148</p></td>
<td><p>49.5</p></td>
<td><p>0.9802 (98%)</p></td>
</tr>
</tbody>
</table>
<p>So, for example, a SHAP value of 0.5 for one particular feature tells us that that particular feature in that patient shifts our expected probability of that patient receiving thrombolysis from 25% to 36%. A SHAP value of 5 for the same feature would shift the probability of that patient receiving thrombolysis up to 98%.</p>
</div>
<div class="section" id="negative-shap-values-examples-of-how-shap-change-odds-and-probabilities">
<h3>Negative SHAP values: examples of how SHAP change odds and probabilities<a class="headerlink" href="#negative-shap-values-examples-of-how-shap-change-odds-and-probabilities" title="Permalink to this headline">¶</a></h3>
<p>If we have a negative SHAP value then odds are reduced (a SHAP of -1 will lead to the odds being divided by 2.72, which is the same as multiplying by 1/2.72, which is 0.3679):</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Starting P</p></th>
<th class="head"><p>Starting O<br>(P / (1 - P))</p></th>
<th class="head"><p>SHAP</p></th>
<th class="head"><p>Shift in odds<br>(exp(SHAP))</p></th>
<th class="head"><p>Shifted O<br>(O * Shift)</p></th>
<th class="head"><p>Shifted P (%)<br>(O / (1 + O))</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-0.5</p></td>
<td><p>0.6065</p></td>
<td><p>0.2022</p></td>
<td><p>0.1682 (17%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-1</p></td>
<td><p>0.3679</p></td>
<td><p>0.1226</p></td>
<td><p>0.1092 (11%)</p></td>
</tr>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-2</p></td>
<td><p>0.1353</p></td>
<td><p>0.0451</p></td>
<td><p>0.0432 (4.3%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-3</p></td>
<td><p>0.0498</p></td>
<td><p>0.0166</p></td>
<td><p>0.0163 (1.6%)</p></td>
</tr>
<tr class="row-even"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-4</p></td>
<td><p>0.0183</p></td>
<td><p>0.0061</p></td>
<td><p>0.0061 (0.61%)</p></td>
</tr>
<tr class="row-odd"><td><p>0.25 (25%)</p></td>
<td><p>0.333</p></td>
<td><p>-5</p></td>
<td><p>0.0067</p></td>
<td><p>0.0022</p></td>
<td><p>0.0022 (0.22%)</p></td>
</tr>
</tbody>
</table>
<p>So, for example, a SHAP value of -0.5 for one particular feature tells us that that particular feature in that patient shifts our expected probability of that patient receiving thrombolysis from 25% to 17%. A SHAP value of 5 for the same feature would shift the probability of that patient receiving thrombolysis down to 2%.</p>
</div>
</div>
<div class="section" id="a-worked-example-in-predicting-use-of-thrombolysis-in-stroke">
<h2>A worked example in predicting use of thrombolysis in stroke<a class="headerlink" href="#a-worked-example-in-predicting-use-of-thrombolysis-in-stroke" title="Permalink to this headline">¶</a></h2>
<p>The example below shows how six patient features change the model prediction of a patient receiving thrombolysis, from a baseline of 25% (with nothing known about the patient) to 95% after the contribution of six features. The relative contribution of each feature is made clear by its SHAP value. SHAP are additive in their effects; for example if one feature has a SHAP of +1.5, the influence of that feature on the model prediction would be exactly cancelled out by three other features with SHAP values of -0.5.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Patient feature and value</p></th>
<th class="head"><p>SHAP</p></th>
<th class="head"><p>Shift<br>(exp(SHAP))</p></th>
<th class="head"><p>Odds<br>(Previous odds * Shift)</p></th>
<th class="head"><p>Probability<br>(O / (1 + O)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Base odds</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>0.33</p></td>
<td><p>25%</p></td>
</tr>
<tr class="row-odd"><td><p>Stroke type = infarction</p></td>
<td><p>1.8</p></td>
<td><p>6.05</p></td>
<td><p>2</p></td>
<td><p>67%</p></td>
</tr>
<tr class="row-even"><td><p>Stroke severity (NIHSS) = 20</p></td>
<td><p>1.5</p></td>
<td><p>4.482</p></td>
<td><p>8.95</p></td>
<td><p>90%</p></td>
</tr>
<tr class="row-odd"><td><p>Prior disability (mRS) = 3</p></td>
<td><p>-0.7</p></td>
<td><p>0.497</p></td>
<td><p>4.44</p></td>
<td><p>82%</p></td>
</tr>
<tr class="row-even"><td><p>Precise onset time = Yes</p></td>
<td><p>0.6</p></td>
<td><p>1.822</p></td>
<td><p>8.1</p></td>
<td><p>89%</p></td>
</tr>
<tr class="row-odd"><td><p>Arrival-to-scan time (mins) = 30</p></td>
<td><p>0.5</p></td>
<td><p>1.649</p></td>
<td><p>13.35</p></td>
<td><p>93%</p></td>
</tr>
<tr class="row-even"><td><p>Use of AF anticoagulants = No</p></td>
<td><p>0.3</p></td>
<td><p>1.35</p></td>
<td><p>18.02</p></td>
<td><p>95%</p></td>
</tr>
</tbody>
</table>
<div class="section" id="observations-about-shap-values">
<h3>Observations about SHAP values<a class="headerlink" href="#observations-about-shap-values" title="Permalink to this headline">¶</a></h3>
<p>We begin to get some intuition on SHAP values. A SHAP value of 0.5 (or -0.5) leads to a small, but still noticeable, change in probability. SHAP values of 5 or -5 have effectively pushed probabilities to one extreme or the other.</p>
<p>Everything we know about a patient (the patient ‘features’) may shift the predicted probability of receiving thrombolysis. Each patient feature will have its own SHAP value depending on the value of that feature. <em>Stroke severity</em>, for example, may be in the range 0-42, and the SHAP value will depend on the value of the feature. The final predicted probability of receiving thrombolysis will be the model baseline prediction (the predicted probability of receiving thrombolysis before anything is known about a patient) and the sum of the influences of each of the features.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./introduction"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../glossary.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Glossary of technical terms</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../shap_worked_example.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">A simple worked example of Shap</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Kerry Pearn & Michael Allen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>